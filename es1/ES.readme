

esä¹‹lucene:
    luceneæ˜¯ä¸€å¥—ä¿¡æ¯æ£€ç´¢å·¥å…·åŒ…ï¼ŒjaråŒ…ï¼Œä¸åŒ…å«æœç´¢å¼•æ“ç³»ç»Ÿï¼›
    åŒ…å«ï¼š 1. ç´¢å¼•ç»“æ„ï¼› 2. è¯»å†™ç´¢å¼•çš„å·¥å…·ï¼›3. ç½‘ç«™æœç´¢æ’åºï¼›4. æœç´¢è§„åˆ™(è¿‡æ»¤å’Œæ¨¡ç³Š)ï¼›
    eså’Œsolræ˜¯åŸºäºluceneçš„ï¼Œ javaç¼–å†™ï¼Œå¼€æºé¡¹ç›®ï¼›


Luceneå’ŒESçš„å…³ç³»ï¼š
    ESåŸºäºluceneï¼Œåšäº†ä¸€äº›å°è£…å’Œå¢å¼ºï¼›


ESç®€ä»‹ï¼š
    esæ˜¯ä¸€ä¸ªé«˜æ‰©å±•çš„åˆ†å¸ƒå¼æ–‡ä»¶æ£€ç´¢ç³»ç»Ÿï¼Œesä¹Ÿæ˜¯ä½¿ç”¨javaå¼€å‘ï¼Œé€šè¿‡restful apiæ¥å®Œæˆ
    å…¨æ–‡æœç´¢ï¼Œå±è”½äº†luceneçš„å¤æ‚æ€§ï¼›
    ç”¨äº:
        1. å…¨æ–‡æœç´¢ï¼› 2. ç»“æ„åŒ–æœç´¢ï¼› 3. åˆ†æï¼› 4. ä»¥åŠè¿™ä¸‰è€…çš„æ··åˆä½¿ç”¨ï¼›

    ç”¨é€”ï¼š 1. Githubï¼› 2. ELKï¼› 3. ç”µå•†å…³é”®å­—ï¼› 4. ç™¾åº¦ç­‰ï¼›


ESå’ŒSolrçš„åŒºåˆ«ï¼š

    éƒ½æ˜¯ç”¨Javaå¼€å‘ï¼Œ éƒ½æ˜¯åŸºäºLucene,  éƒ½å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œ éƒ½æ˜¯å‘ESæˆ–è€…Solr
    æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œè¿”å›xmlæˆ–è€…jsonï¼›

    ESæ˜¯restful apié£æ ¼ï¼Œ solræ˜¯web-serverçš„apiæ¥å£é£æ ¼ï¼›

    1. å¯¹å•çº¯çš„æ•°æ®åº“ä¸­å·²æœ‰çš„æ•°æ®ï¼Œ solré€Ÿåº¦å¿«ï¼›
    2. éšç€æ•°æ®é‡çš„å¢åŠ ï¼ŒSolrçš„æœç´¢æ•ˆç‡ä¼šé™ä½ï¼Œè€ŒESå´æ²¡æœ‰æ˜æ˜¾çš„å˜åŒ–ï¼›
    3. Solråˆ©ç”¨Zookeeperè¿›è¡Œåˆ†å¸ƒå¼ç®¡ç†ï¼Œ ESè‡ªèº«å¸¦æœ‰åˆ†å¸ƒå¼ç®¡ç†åŠŸèƒ½ï¼›
    4. Solræä¾›çš„å®˜æ–¹åŠŸèƒ½æ›´å¤šï¼ŒESæ›´æ³¨é‡æ ¸å¿ƒåŠŸèƒ½ï¼Œä¾‹å¦‚å›¾å½¢åŒ–éœ€è¦kibanaçš„æ”¯æ’‘ï¼›
    5. SolræŸ¥è¯¢å¿«ï¼Œä½†æ˜¯æ›´æ–°ç´¢å¼•æ…¢ï¼Œç”¨äºç”µå•†æŸ¥è¯¢å¤šï¼›
       ESå»ºç«‹ç´¢å¼•å¿«ï¼Œå®æ—¶æ€§æŸ¥è¯¢å¿«ï¼›
    6. Solrå¼€å‘ç¤¾åŒºæ¯”è¾ƒæˆç†Ÿï¼ŒESç»´æŠ¤å¼€å‘è€…è¾ƒå°‘ï¼Œæ›´æ–°è¾ƒå¿«ï¼›
    7. ESä»…æ”¯æŒjsonæ ¼å¼ï¼Œ Solræ”¯æŒjsonï¼Œxmlï¼Œcsvï¼›


ELKï¼š
    elasticsearchã€ Kibanaã€ Logstash

    1. é€šè¿‡Logstashæ”¶é›†æ¸…æ´—æ•°æ®ï¼›
    2. é€šè¿‡esåˆ†ææ•°æ®ï¼›
    3. é€šè¿‡Kibanaå±•ç¤ºæ•°æ®ï¼›

    ELKå¸¸ç”¨ä¸æ—¥å¿—åˆ†æï¼Œ ä¹Ÿå¯ç”¨äºå…¶ä»–å¤§æ•°æ®æ•°æ®æ¸…æ´—å’Œåˆ†æï¼›


1. esçš„å®‰è£…ï¼›
    ESåŸºäºJavaï¼Œ è¦æ±‚jdk1.8åŠä»¥ä¸Šï¼Œéœ€è¦å®‰è£…ç•Œé¢å·¥å…·Kibanaï¼Œ
    ESçš„ç‰ˆæœ¬éœ€è¦å’Œä¹‹åå¯¹åº”çš„Javaç‰ˆæœ¬å¯¹åº”ï¼›
    Kibanaçš„ç‰ˆæœ¬ä¹Ÿéœ€è¦å’ŒESç‰ˆæœ¬ä¸€ç›´ï¼›

    1. å®˜ç½‘ä¸‹è½½elasticå’ŒKibanaï¼š https://www.elastic.com/ ,
        è§£å‹å³å¯ä½¿ç”¨ï¼›

       åæ–‡äº‘ä¸‹è½½ï¼š
        ElasticSearch: https://mirrors.huaweicloud.com/elasticsearch/?C=N&O=D
        Logstash: https://mirrors.huaweicloud.com/logstash/?C=N&O=D
        kibana: https://mirrors.huaweicloud.com/kibana/?C=N&O=D

    2.
        å¯åŠ¨elasticsearch:
        cd /Library/elasticsearch-7.6.0/bin && elasticsearch
        è®¿é—®ï¼š localhost:9200
        esé»˜è®¤ç«¯å£ï¼š 9200

        {
          "name" : "macOfEthandeMacBook-Pro-2.local",
          "cluster_name" : "elasticsearch", //é»˜è®¤é›†ç¾¤åå­—
          "cluster_uuid" : "SEVCjUNAQOCQ7wkUK7w1sg", //é›†ç¾¤id
          "version" : {
            "number" : "7.6.0", //esç‰ˆæœ¬
            "build_flavor" : "default",
            "build_type" : "tar",
            "build_hash" : "7f634e9f44834fbc12724506cc1da681b0c3b1e3",
            "build_date" : "2020-02-06T00:09:00.449973Z",
            "build_snapshot" : false,
            "lucene_version" : "8.4.0", //luceneç‰ˆæœ¬
            "minimum_wire_compatibility_version" : "6.8.0",
            "minimum_index_compatibility_version" : "6.0.0-beta1"
          },
          "tagline" : "You Know, for Search" //
        }

        å¯åŠ¨Kibana:
            cd /Users/macofethan/Downloads/kibana-7.6.0-darwin-x86_64/bin/ && kibana
            localhost:5601
            kibanaé»˜è®¤ç«¯å£ï¼š 5601

          åœ¨Kibanaçš„devtool(å€’æ•°ç¬¬ä¸‰ä¸ªğŸ”§å›¾æ ‡ä¸‹)ï¼Œå¯ä»¥è¿›è¡Œç›¸å…³çš„æµ‹è¯•ï¼›

        æ±‰åŒ–Kibanaï¼š
             ä¿®æ”¹./config/kibana.yml, é‡æ–°å¯åŠ¨kibana:
             i18n.locale: "zh-CN"


    3. å®‰è£…å¯è§†åŒ–es headçš„æ’ä»¶ï¼š
        elasticsearch-headå»ºè®®åªç”¨æ¥å±•ç¤ºæ•°æ®ï¼ŒæŸ¥è¯¢å»ºè®®ç”¨Kibanaï¼›
        åŸºäºnpmï¼Œ æ‰€ä»¥éœ€è¦æ­å»ºnodejsç¯å¢ƒï¼›
        ä¸‹è½½åœ°å€ï¼š https://github.com/mobz/elasticsearch-head
        cd elasticsearch-head
        npm install
        npm run start

        è®¿é—®ï¼š localhost:9100   é»˜è®¤ä¼šå­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œ éœ€è¦åœ¨elasticsearché‡Œé¢
        é…ç½®è·¨åŸŸå¹¶é‡æ–°å¯åŠ¨esæœåŠ¡å™¨:

            vim ./config/elasticsearch.yml

            # é…ç½®è·¨åŸŸ
            http.cors.enabled: true
            http.cors.allow-origin: "*"


    4. esç´¢å¼•ï¼š
        å¦‚æœesç›¸å½“äºä¸€ä¸ªæ•°æ®åº“ï¼Œ é‚£ä¹ˆç´¢å¼•ç›¸å½“äºä¸€ä¸ªåº“ï¼Œæ–‡æ¡£ç›¸å½“äºåº“ä¸­çš„æ•°æ®ï¼›



é¢å‘æ–‡æ¡£ï¼š mysqlä¸esçš„å¯¹æ¯”, åœ¨esä¸­ä¸€åˆ‡éƒ½æ˜¯json

    mysql            ä¸      elasticsearchå¯¹æ¯”ï¼š
    æ•°æ®åº“ database            ç´¢å¼•indices (å’Œæ•°æ®åº“ä¸€æ ·)
    è¡¨tables                  types (æ…¢æ…¢è¢«å¼ƒç”¨)
    è¡Œrows                    documents (æ•°æ®å¯¹åº”æ–‡æ¡£)
    å­—æ®µcolumns                fields



ä¸€ä¸ªesç´¢å¼•é»˜è®¤æƒ…å†µä¸‹åŒ…å«5ä¸ªåŸºäºluceneçš„åˆ†ç‰‡ï¼Œæ‰€ä»¥esæ˜¯åˆ©ç”¨äº†luceneç´¢å¼•è¿›è¡Œäº†å°è£…ï¼Œ
åŠ ä¸Šå€’æ’ç´¢å¼•ï¼ˆluceneç´¢å¼•ï¼‰çš„ä½¿ç”¨ä½¿å¾—esèƒ½å¤Ÿæ›´å¿«åœ°æ‰¾åˆ°å…·ä½“çš„å…³é”®è¯ï¼Œæ’é™¤æ— å…³çš„å…³é”®è¯æœç´¢ï¼›




2. esåˆ†è¯å™¨ ikåˆ†è¯å™¨:

    ä½œç”¨ï¼š å°†æˆ‘ä»¬æä¾›çš„å…³é”®è¯åˆ†æˆå¤šä¸ªå­å…³é”®è¯ï¼› æ¯”å¦‚czyåˆ†æˆc,z,y czy, czç­‰ç­‰ï¼›

   ikåˆ†è¯å™¨:
    ä¸‹è½½ä¸å®‰è£…ï¼š
    https://github.com/medcl/elasticsearch-analysis-ik, ä¸‹è½½å¯¹åº”çš„jaråŒ…ï¼›
    https://github.com/medcl/elasticsearch-analysis-ik/releases?after=v7.6.2
    ä¸‹è½½å®Œæˆåæ”¾å…¥elasticsearchæ’ä»¶ä¸­ï¼›
    é‡å¯è§‚å¯Ÿelasticsearch;
    é€šè¿‡elasticsearch-plugin listï¼›æŸ¥çœ‹å¯ç”¨çš„æ’ä»¶ï¼›


    ikåˆ†è¯å™¨çš„ä¸¤ç§æ¨¡å¼ï¼š
        ik_smart: æœ€å°‘åˆ‡åˆ†ï¼›
        ik_max_word: æœ€ç»†ç²’åº¦åˆ’åˆ†ï¼›

        ik_smartæ¨¡å¼ï¼š
        GET _analyze
        {
          "analyzer": "ik_smart",
          "text": "ä¸­å›½äºº"

        }

        å°†åˆ†æˆï¼š
            {
              "tokens" : [
                {
                  "token" : "ä¸­å›½äºº",
                  "start_offset" : 0,
                  "end_offset" : 3,
                  "type" : "CN_WORD",
                  "position" : 0
                },
                {
                  "token" : "æ‚¨å¥½",
                  "start_offset" : 3,
                  "end_offset" : 5,
                  "type" : "CN_WORD",
                  "position" : 1
                }
              ]
            }


        ik_max_word:

        GET _analyze
        {
          "analyzer": "ik_max_word",
          "text": "ä¸­å›½äººæ‚¨å¥½"
        }

        å°†åˆ†æˆï¼š
        {
          "tokens" : [
            {
              "token" : "ä¸­å›½äºº",
              "start_offset" : 0,
              "end_offset" : 3,
              "type" : "CN_WORD",
              "position" : 0
            },
            {
              "token" : "ä¸­å›½",
              "start_offset" : 0,
              "end_offset" : 2,
              "type" : "CN_WORD",
              "position" : 1
            },
            {
              "token" : "å›½äºº",
              "start_offset" : 1,
              "end_offset" : 3,
              "type" : "CN_WORD",
              "position" : 2
            },
            {
              "token" : "æ‚¨å¥½",
              "start_offset" : 3,
              "end_offset" : 5,
              "type" : "CN_WORD",
              "position" : 3
            }
          ]
        }


    å¦‚ä½•å°†æŸäº›å­å…³é”®å­—è®¾ç½®ä¸ºä¸€ä¸ªå…³é”®å­—ï¼š
      éœ€è¦å°†è¿™äº›å…³é”®å­—åŠ å…¥ikåˆ†è¯å™¨ä¸­ï¼Œä½ ä»¬ikåˆ†è¯å™¨å¦‚ä½•å¢åŠ è‡ªå®šä¹‰é…ç½®ï¼š
      å¯ä»¥åœ¨ikåˆ†è¯å™¨æ’ä»¶configæ–‡ä»¶IKAnalyzer.cfg.xmlä¸­é…ç½®æ‰©å±•è¯å…¸ï¼š

        <?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">
        <properties>
            <comment>IK Analyzer æ‰©å±•é…ç½®</comment>
            <!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ -->
            <entry key="ext_dict">czy.dic</entry>
             <!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸-->
            <entry key="ext_stopwords"></entry>
            <!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ -->
            <!-- <entry key="remote_ext_dict">words_location</entry> -->
            <!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸-->
            <!-- <entry key="remote_ext_stopwords">words_location</entry> -->
        </properties>


        åœ¨IKAnalyzer.cfg.xmlåŒçº§ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªczy.dicæ–‡ä»¶ï¼Œ æ·»åŠ è‡ªå®šä¹‰çš„å…³é”®å­—ï¼›
        å‘µå“ˆé»‘

        é‡æ–°å¯åŠ¨elasticsearch, æ§åˆ¶å°ä¼šæ˜¾ç¤ºæˆåŠŸåŠ è½½è‡ªå®šä¹‰çš„è¯å…¸ï¼Œ åœ¨Kibanaä¸­é‡æ–°æŸ¥è¯¢åˆ†è¯ï¼š
        {
          "tokens" : [
            {
              "token" : "å‘µå“ˆé»‘",
              "start_offset" : 0,
              "end_offset" : 3,
              "type" : "CN_WORD",
              "position" : 0
            }
          ]
        }




3. es restfulæ“ä½œï¼›

    #3.1, eså…³äºç´¢å¼•çš„æ“ä½œï¼š

    method         urlåœ°å€                                æè¿°
    put         localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id     åˆ›å»ºæ–‡æ¡£(æŒ‡å®šæ–‡æ¡£id)
    post        localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°           åˆ›å»ºæ–‡æ¡£(éšæœºæ–‡æ¡£id)
    post        localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id/_update   ä¿®æ”¹æ–‡æ¡£
    delete      localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id           åˆ é™¤æ–‡æ¡£
    get         localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id           é€šè¿‡idæŸ¥æ‰¾æ–‡æ¡£
    post        localhost:9200/ç´¢å¼•åç§°/ç±»å‹åç§°/_search         æŸ¥è¯¢æ‰€æœ‰æ•°æ®


    ç±»å‹åç§°ä¸æŒ‡å®šæ—¶ï¼Œ é»˜è®¤ä¸º_doc, ç±»å‹åç§°å°†æ¥ä¼šè¢«å¼ƒç”¨ï¼Œå› æ­¤ä½¿ç”¨é»˜è®¤çš„å°±è¡Œäº†

    Kibanaæ“ä½œç´¢å¼•å½¢å¼ï¼š
    method /ç´¢å¼•åç§°/ç±»å‹åç§°/æ–‡æ¡£id
    {
        "å­—æ®µ1":"å­—æ®µ1çš„å€¼",
        "å­—æ®µ2":"å­—æ®µ2çš„å€¼"
    }

    ä¾‹å­ï¼Œ åœ¨kibanaæ§åˆ¶å°ï¼š

    1. åˆ›å»ºç´¢å¼•ä¸ºzs, ç±»å‹ä¸ºtype1ï¼Œ idä¸º1çš„æ–‡æ¡£
        PUT /zs/type1/1
        {
          "name": "å¼ ä¸‰",
          "age":20
        }

    2. ä¿®æ”¹ç´¢å¼•,ç›´æ¥è¦†ç›–ï¼š
        PUT /zs/_doc/1
        {
          "name":"zz"
        }

        ä¿®æ”¹å­—æ®µåç§°ï¼š
        POST /zs/_doc/1/_update
        {
          "doc":{ //æ‰€æœ‰çš„å­—æ®µéƒ½æ”¾åœ¨docå¯¹åº”ä¸‹é¢ä¿®æ”¹
            "name":"yy"
          }
        }

    3. äº§çœ‹ç´¢å¼•ä¿¡æ¯ï¼š
        GET /zs/_doc/1


    4. åˆ é™¤ç´¢å¼•ï¼š
        ä¼šæ ¹æ®è¯·æ±‚è·¯å¾„æ¥åˆ é™¤åº“è¿˜æ˜¯åˆ é™¤æ–‡æ¡£
        DELETE /zs //åˆ é™¤åº“
        DELETE /zs/_doc/1 //åˆ é™¤æ–‡æ¡£


    #esæ•°æ®ç±»å‹ï¼š
        1. å­—ç¬¦ä¸²ç±»å‹ï¼š text, keyword
        2. æ•°å€¼ç±»å‹ï¼š long, integer, short, byte, double, float, half float,
                    scaled float
        3. æ—¥æœŸç±»å‹ï¼š date
        4. å¸ƒå°”ç±»å‹ï¼š boolean
        5. äºŒè¿›åˆ¶ç±»å‹ï¼š binary
        ç­‰ç­‰



    #åˆ›å»ºç´¢å¼•çš„æ—¶å€™æŒ‡å®šå­—æ®µç±»å‹ï¼š
        ä¾‹å­ï¼šåœ¨Kibanaæ§åˆ¶å°åˆ›å»ºä¸€ä¸ªç´¢å¼•ï¼Œä¸æ·»åŠ æ–‡æ¡£ï¼š
        PUT /wangwu
        {
          "mappings": {
            "properties": {
              "name":{
                "type": "text"
              },
              "age":{
                "type": "integer"
              }
            }
          }
        }

        # æ³¨æ„ï¼Œå£°æ˜çš„å­—æ®µå¯ä»¥é‡‡ç”¨æ•°ç»„çš„å½¢å¼æ·»åŠ å­—æ®µå€¼


    # åœ¨kibanaä¸­æŸ¥çœ‹esç³»ç»Ÿä¿¡æ¯
    GET _cat/health  //æŸ¥çœ‹eså¥åº·ä¿¡æ¯
    GET _cat/indices //æŸ¥çœ‹ç´¢å¼•åˆ—è¡¨



    #3.2, eså…³äºæ–‡æ¡£çš„æ“ä½œï¼š

        1. æ–°å¢æ–‡æ¡£ï¼Œ é€šè¿‡æ”¹å˜idæ–°å¢æ•°æ®ï¼š
            PUT /czy/_doc/3
            {
              "name":"ç‹äº”",
              "age":"35",
              "tag":["H5", "VUE"],
              "desc":"é€å¿«é€’"
            }

        2. æ–°å¢æ•°æ®ï¼Œ å»ºè®®ä½¿ç”¨post+/_update, ä½¿ç”¨putä¼šç›´æ¥è¦†ç›–(å…¶ä»–å­—æ®µå…¨è¢«è¢«ç½®ä¸ºç©º)ï¼š
            POST /czy/_doc/2/_update
            {
              "doc":{
                "name":"å¼ ä¸‰"
              }
            }

            # æ³¨æ„:è¿™æ ·ç›¸å½“äºPUTï¼Œä¹Ÿä¼šå°†å…¶ä»–å­—æ®µç½®ä¸ºç©º
            POST /czy/_doc/2
            {
              "doc":{
                "name":"å¼ ä¸‰"
              }
            }

        3. æŸ¥è¯¢æ•°æ®ï¼š
            1. ç®€å•çš„é€šè¿‡æ–‡æ¡£idæŸ¥è¯¢
            GET /czy/_doc/2

            2.é€šè¿‡ /ç´¢å¼•åç§°/ç±»å‹åç§°/_search?q=key1:value1&q=key2:value2 æ ¹æ®å…³é”®å­—æŸ¥æ‰¾
            GET /czy/_doc/_search?q=name:ç‹

            3. å¤æ‚æŸ¥è¯¢ï¼ˆæ’åºï¼Œ åˆ†é¡µï¼Œ é«˜äº®ï¼Œ æ¨¡ç³ŠæŸ¥è¯¢ï¼Œ ç²¾å‡†æŸ¥è¯¢ï¼‰

            #1. ä½¿ç”¨query jsonå‚æ•°ä½“æŸ¥è¯¢ï¼š
            GET /czy/_doc/_search
            {
              "query":{
                "match":{
                  "name":"äº”"
                }
              }
            }

            # æŸ¥è¯¢ç»“æœ
            {
              "took" : 0,
              "timed_out" : false,
              "_shards" : {
                "total" : 1,
                "successful" : 1,
                "skipped" : 0,
                "failed" : 0
              },
              "hits" : {
                "total" : {
                  "value" : 2, //åŒ¹é…çš„æ€»æ•°
                  "relation" : "eq" //ä¸å…³é”®è¯çš„å…³ç³»
                },
                "max_score" : 0.8083933, //æœ€åŒ¹é…çš„æ–‡æ¡£çš„åˆ†å€¼
                "hits" : [ //æ‰€æœ‰æ–‡æ¡£ä¿¡æ¯
                  {
                    "_index" : "czy",
                    "_type" : "_doc",
                    "_id" : "4",
                    "_score" : 0.8083933, //æ–‡æ¡£åˆ†å€¼
                    "_source" : {
                      "name" : "èµµäº”äº”",
                      "age" : 30,
                      "desc" : "zhaowu",
                      "tag" : [
                        "iOS"
                      ]
                    }
                  },
                  {
                    "_index" : "czy",
                    "_type" : "_doc",
                    "_id" : "3",
                    "_score" : 0.6682933,
                    "_source" : {
                      "name" : "ç‹äº”",
                      "age" : "35",
                      "tag" : [
                        "H5",
                        "VUE"
                      ],
                      "desc" : "é€å¿«é€’"
                    }
                  }
                ]
              }
            }



        #2. åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µä¿¡æ¯ï¼š
            GET /czy/_doc/_search
            {
              "query":{
                "match":{
                  "name":"äº”"
                }
              },
              "_source":["name", "age"] //ç»“æœè¿‡æ»¤
            }


        #3. æ’åº
            æ³¨æ„ï¼š 1. textç±»å‹çš„å­—æ®µä¸æ”¯æŒæ’åºï¼Œ æ‰€ä»¥å£°æ˜æ–‡æ¡£å­—æ®µçš„æ—¶å€™æœ€å¥½ä½¿ç”¨
                    keywordç±»å‹æˆ–è€…integerç±»å‹;
                  2. keywordç±»å‹çš„å­—æ®µï¼ŒqueryæŸ¥è¯¢æ—¶åªèƒ½è¿›è¡Œå…¨éƒ¨åŒ¹é…ï¼Œä¸èƒ½éƒ¨åˆ†
                    åŒ¹é…ï¼›textç±»å‹çš„å­—æ®µå¯ä»¥è¿›è¡Œéƒ¨åˆ†åŒ¹é…ï¼›

            //æ ¹æ®ageå‡åºæ’åˆ—
            GET /czy/_doc/_search
            {
              "sort":{
                "age":{
                  "order": "asc"
                }
              }
            }



        #4. åˆ†é¡µæŸ¥è¯¢: from+size

            GET /czy/_doc/_search
            {
              "sort":{
                "age":{
                  "order": "asc"
                }
              },
              "from":0, //ä»é‚£ä¸€é¡µèµ·, èµ·å§‹ä¸‹æ ‡
              "size":1  //æŸ¥è¯¢å¤šå°‘æ¡
            }


        #5. å¸ƒå°”å€¼æŸ¥è¯¢, å¤šæ¡ä»¶æŸ¥è¯¢ï¼š

        //mustï¼š æ‰€æœ‰æ¡ä»¶éƒ½éœ€è¦æ»¡è¶³ï¼Œç›¸å½“äºandï¼›
        GET /czy/_doc/_search
        {
          "query": {
            "bool": {
              "must": [
                  {
                    "match": {
                      "name": "æå››"
                    }
                  },
                  {
                    "match": {
                      "age": 10
                    }
                  }
                ]
            }
          }
        }


        //should: ç›¸å½“äºor
        GET /czy/_doc/_search
        {
          "query": {
            "bool": {
              "should": [
                  {
                    "match": {
                      "name": "æå››"
                    }
                  },
                  {
                    "match": {
                      "age": 20
                    }
                  }
                ]
            }
          }
        }


        //must_not: æŸ¥è¯¢æ‰€æœ‰ä¸æ»¡è¶³æ¡ä»¶çš„æ–‡æ¡£, ç›¸å½“äºnot
        GET /czy/_doc/_search
        {
          "query": {
            "bool": {
              "must_not": [
                  {
                    "match": {
                      "age": 20
                    }
                  }
                ]
            }
          }
        }


        #6. è¿‡æ»¤å™¨ï¼š

            //æŸ¥è¯¢å¹´é¾„å°äº20çš„æ•°æ®
            //lt: å°äº  gt: å¤§äº  lte:å°äºç­‰äº gte:å¤§äºç­‰äº
            GET /czy/_doc/_search
            {
              "query": {
                "bool": {
                  "filter":{
                    "range":{
                      "age":{
                        "gte": 20,  //>=20
                        "lt":50     //<50
                      }
                    }
                  }
                }
              }
            }


        #7. åŒ¹é…å¤šä¸ªæ¡ä»¶, å¯¹textç±»å‹çš„å­—æ®µå¯ä»¥ç”¨ç©ºæ ¼åˆ†å¼€å¤šä¸ªå…³é”®å­—ï¼Œ
        æŸ¥è¯¢æ‰€æœ‰åŒ¹é…çš„æ•°æ®ï¼š
        GET /czy/_doc/_search
        {
          "query":{
            "match":{
              "tag":"iOS Java web"
            }
          }
        }


        #8. ç²¾ç¡®æŸ¥è¯¢ï¼š
        termæŸ¥è¯¢ï¼šæ˜¯ç›´æ¥é€šè¿‡å€’æ’ç´¢å¼•æŒ‡å®šçš„è¯æ¡è¿›è¡Œç²¾ç¡®æŸ¥æ‰¾çš„ï¼Œæ•ˆç‡è¾ƒé«˜ï¼›
        matchæŸ¥è¯¢ï¼š ä¼šä½¿ç”¨åˆ†æå™¨ï¼Œå…ˆåˆ†ææ–‡æ¡£ï¼Œç„¶åé€šè¿‡åˆ†æçš„æ–‡æ¡£è¿›è¡ŒæŸ¥è¯¢ï¼›

        //å•ä¸ªå€¼çš„ç²¾ç¡®æŸ¥è¯¢
        GET /czy/_doc/_search
        {
          "query":{
            "term":{
              "age":20
            }
          }
        }

        //å¤šä¸ªå€¼åŒ¹é…çš„ç²¾ç¡®æŸ¥è¯¢
        GET /czy/_doc/_search
        {
          "query": {
            "bool":{
              "should":[
                  {
                    "term":{
                      "age": 20
                    }
                  },
                  {
                    "term":{
                      "name":"lisi"
                    }
                  }
                ]
            }
          }
        }


        # textç±»å‹å’Œkeywordç±»å‹çš„åŒºåˆ«ï¼š
        textç±»å‹ä¼šè¢«åˆ†è¯è§£æå™¨è§£æ(ä¹Ÿå°±æ˜¯ä¼šè¢«åˆ†å‰²)ï¼›
         keywordç±»å‹ä¸ä¼šè¢«åˆ†è¯è§£æå™¨è§£æï¼ˆä¹Ÿå°±æ˜¯ä¸ä¼šè¢«åˆ†å‰²ï¼‰ï¼›

        //ç»“æœä¸ä¼šè¢«æ‹†å¼€
        GET _analyze
        {
            "analyzer": "keyword",
            "text": "æˆ‘æ˜¯ä¸­å›½äºº"
        }

        //ç»“æœä¼šè¢«æ‹†å¼€
        GET _analyze
        {
            "analyzer": "standard",
            "text": "æˆ‘æ˜¯ä¸­å›½äºº"
        }


        #9. é«˜äº®æŸ¥è¯¢ï¼š
         GET /czy/_doc/_search
         {
           "query":{
             "match":{
               "name":"zhangsan"
             }
           },
           "highlight":{
             "pre_tags":"<p class='keywords'>", //è‡ªå®šä¹‰æ ‡ç­¾å‰ç¼€
             "post_tags":"</p>", //è‡ªå®šä¹‰æ ‡ç­¾åç¼€
             "fields":{
               "name":{}
             }
           }
         }

         //æŸ¥è¯¢å‡ºæ¥çš„ç»“æœï¼Œ é»˜è®¤ä¼šç”¨emæ ‡ç­¾åŒ…è£¹åŒ¹é…çš„å…³é”®å­—ï¼š
         "hits" : [
               {
                 "_index" : "czy",
                 "_type" : "_doc",
                 "_id" : "1",
                 "_score" : 0.9808291,
                 "_source" : {
                   "name" : "zhangsan",
                   "age" : 20,
                   "desc" : "zhangsan desc",
                   "tag" : [
                     "iOS",
                     "Java"
                   ]
                 },
                 "highlight" : {
                   "name" : [
                     "<p class='keywords'>zhangsan</p>"
                   ]
                 }
               }
             ]





5. springbooté›†æˆesï¼›

      1.



6. çˆ¬è™«æŠ“å–æ•°æ®ï¼›

7. æ¨¡æ‹Ÿå¤§æ•°æ®é‡ä¸‹ï¼Œäº¬ä¸œå…³é”®å­—æœç´¢ï¼›
